source('dataclean.r')
source('friedmantest.r')

library(ggplot2)
library(questionr)
library(effsize)



results <- getFullResults() 



TT <- results %>%
  group_by(project,bug_id,TARGET_CLASS) %>%
  summarise(count = n())

configs <- results %>%
  group_by(configuration) %>%
  summarise(count = n())

# Pairwise comparison between different cases and configuration
pairwise <- results %>%
  filter(configuration != 'DynaMOSA') %>%
  inner_join(
    results %>%
      filter(configuration == 'DynaMOSA'),
    by = c('project', 'bug_id', 'case', 'TARGET_CLASS'),
    suffix = c('.config', '.base')) %>%
  group_by(project, bug_id, case, TARGET_CLASS, configuration.config)  %>%
  summarise(BranchCoverage.VD.magnitude = VD.A(BranchCoverage.config, BranchCoverage.base)$magnitude,
            BranchCoverage.VD.estimate = VD.A(BranchCoverage.config, BranchCoverage.base)$estimate,
            BranchCoverage.wilcox.test.pvalue = wilcox.test(BranchCoverage.config, BranchCoverage.base)$p.value,
            WeakMutationScore.VD.magnitude = VD.A(WeakMutationScore.config, WeakMutationScore.base)$magnitude,
            WeakMutationScore.VD.estimate = VD.A(WeakMutationScore.config, WeakMutationScore.base)$estimate,
            WeakMutationScore.wilcox.test.pvalue = wilcox.test(WeakMutationScore.config, WeakMutationScore.base)$p.value,
            OutputCoverage.VD.magnitude = VD.A(OutputCoverage.config, OutputCoverage.base)$magnitude,
            OutputCoverage.VD.estimate = VD.A(OutputCoverage.config, OutputCoverage.base)$estimate,
            OutputCoverage.wilcox.test.pvalue = wilcox.test(OutputCoverage.config, OutputCoverage.base)$p.value) %>%
  mutate(BranchCoverage.VD.estimate.category = case_when(
    BranchCoverage.VD.estimate < 0.5 ~ '< 0.5',
    BranchCoverage.VD.estimate > 0.5 ~ '> 0.5',
    TRUE ~ '= 0.5'),
    WeakMutationScore.VD.estimate.category = case_when(
      WeakMutationScore.VD.estimate < 0.5 ~ '< 0.5',
      WeakMutationScore.VD.estimate > 0.5 ~ '> 0.5',
      TRUE ~ '= 0.5'),
    OutputCoverage.VD.estimate.category = case_when(
      OutputCoverage.VD.estimate < 0.5 ~ '< 0.5',
      OutputCoverage.VD.estimate > 0.5 ~ '> 0.5',
      TRUE ~ '= 0.5'))

# ######################################################
# Branch Coverage
# ######################################################

results %>%
  group_by(configuration,project,bug_id) %>%
  summarise(mean_branch_coverage = mean(BranchCoverage),
            sd_branch_coverage = sd(BranchCoverage),
            median_branch_coverage = median(BranchCoverage),
            iqr_branch_coverage = IQR(BranchCoverage)) %>%
  arrange(mean_branch_coverage) %>%
  print(n=Inf)

results %>%
  ggplot(aes(x = configuration, y = BranchCoverage)) +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  xlab(NULL) +
  ylab('Branch coverage') +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5))
ggsave("output/appendix-branch-coverage.pdf", width = 4.5, height = 3)



results %>%
  ggplot(aes(x = configuration, y = BranchCoverage)) +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  facet_grid(project ~ configuration, margins= "project", scales = "free_x")

# Plotting VD-estimate for significant cases
pairwise %>%
  filter(BranchCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  ggplot(aes(x = configuration.config, y = BranchCoverage.VD.estimate)) +
  geom_boxplot() +
  stat_summary(
    fun.data = function(x){stat_box_data(x, upper_limit = 1.15)}, 
    geom = "text", 
    hjust = 0.5,
    vjust = 0.9
  ) +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  geom_hline(yintercept = 0.5, linetype=2, color="blue") +
  xlab(NULL) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab('VD') +
  scale_y_continuous(limits = c (0.0, 1.2), breaks = c(0.25, 0.5, 0.75, 1.0))
ggsave("output/appendix-branch-vd.pdf", width = 4.5, height = 3.5)


pairwise_magnitude <- pairwise %>%
  filter(BranchCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  filter(BranchCoverage.VD.magnitude != "negligible") %>%
  rename(magnitude = BranchCoverage.VD.magnitude,
         category = BranchCoverage.VD.estimate.category,
         configuration = configuration.config) %>%
  group_by(magnitude, category, configuration) %>%
  summarise(count = n())

pairwise_magnitude %>% 
  ggplot(aes(x=configuration, fill=magnitude)) +
  geom_bar(data = filter(pairwise_magnitude, category == '> 0.5'), 
           aes(y = count, fill = magnitude), stat = "identity") +
  geom_bar(data = filter(pairwise_magnitude, category == '< 0.5'), 
           aes(y = -count, fill = magnitude), stat = "identity") +
  geom_hline(yintercept=0) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab("Count") +
  scale_fill_brewer(palette = COLOR_PALETTE)
ggsave("output/appendix-branch-magnitude.pdf", width = 4.5, height = 3.5)


cat("Branch coverage effect size magnitude: \n")
pairwise_magnitude %>%
  filter(magnitude == 'large') %>%
  arrange(count) %>%
  print(n = Inf)



# Analysis using Friedman's test

cat("Ranking for Branch Coverage:", "\n")

meanBranchCoverage <- results %>%
  group_by(project, bug_id, case, configuration) %>%
  summarise(mean_branch_coverage = mean(BranchCoverage),
            sd_branch_coverage = sd(BranchCoverage)) %>%
  as.data.frame()

apply_conover(meanBranchCoverage$mean_branch_coverage, 
              meanBranchCoverage$configuration, 
              meanBranchCoverage$case)

apply_friedman_test(meanBranchCoverage$mean_branch_coverage, 
                    meanBranchCoverage$configuration, 
                    meanBranchCoverage$case)

pdf("output/appendix-branch-friedman-nemenyi.pdf", width=7, height=6) 
meanBranchCoverage %>%
  select(case, configuration, mean_branch_coverage) %>%
  mutate(mean_branch_coverage = 1 - mean_branch_coverage) %>% #The lowest is the best in our case
  pivot_wider(names_from = configuration, values_from = mean_branch_coverage) %>%
  select(-case) %>%
  as.matrix() %>%
  nemenyi(plottype = "vmcb", conf.level = 1.0 - SIGNIFICANCE_LEVEL)
dev.off()



# ######################################################
# Output Coverage
# ######################################################

results %>%
  group_by(configuration) %>%
  summarise(mean_output_coverage = mean(OutputCoverage),
            sd_output_coverage = sd(OutputCoverage),
            median_output_coverage = median(OutputCoverage),
            iqr_output_coverage = IQR(OutputCoverage)) %>%
  arrange(mean_output_coverage)

results %>%
  ggplot(aes(x = configuration, y = OutputCoverage)) +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  xlab(NULL) +
  ylab('Output coverage') +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5))
ggsave("output/appendix-output-coverage.pdf", width = 4.5, height = 3)

# Plotting VD-estimate for significant cases
pairwise %>%
  filter(OutputCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  ggplot(aes(x = configuration.config, y = OutputCoverage.VD.estimate)) +
  geom_boxplot() +
  stat_summary(
    fun.data = function(x){stat_box_data(x, upper_limit = 1.15)}, 
    geom = "text", 
    hjust = 0.5,
    vjust = 0.9
  ) +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  geom_hline(yintercept = 0.5, linetype=2, color="blue") +
  xlab(NULL) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab('VD') +
  scale_y_continuous(limits = c (0.0, 1.2), breaks = c(0.25, 0.5, 0.75, 1.0))
ggsave("output/appendix-output-vd.pdf", width = 4.5, height = 3.5)

# Output coverage effect size magnitude

pairwise_magnitude <- pairwise %>%
  filter(OutputCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  filter(OutputCoverage.VD.magnitude != "negligible") %>%
  rename(magnitude = OutputCoverage.VD.magnitude,
         category = OutputCoverage.VD.estimate.category,
         configuration = configuration.config) %>%
  group_by(magnitude, category, configuration) %>%
  summarise(count = n())

pairwise_magnitude %>% 
  ggplot(aes(x=configuration, fill=magnitude)) +
  geom_bar(data = filter(pairwise_magnitude, category == '> 0.5'), 
           aes(y = count, fill = magnitude), stat = "identity") +
  geom_bar(data = filter(pairwise_magnitude, category == '< 0.5'), 
           aes(y = -count, fill = magnitude), stat = "identity") +
  geom_hline(yintercept=0) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab("Count") +
  scale_fill_brewer(palette = COLOR_PALETTE)
ggsave("output/appendix-output-magnitude.pdf", width = 4.5, height = 3.5)

cat("Output coverage effect size magnitude: \n")
pairwise_magnitude %>%
  filter(magnitude == 'large') %>%
  arrange(count)
print(n = Inf)

cat("Target classes for which BBC has a large negative effect size: \n")
pairwise %>%
  filter(OutputCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL, OutputCoverage.VD.magnitude == 'large', OutputCoverage.VD.estimate.category == "< 0.5") %>%
  group_by(project, bug_id, case, TARGET_CLASS) %>%
  summarise(config.count = n())

# Analysis using Friedman's test

cat("Ranking for Output Coverage:", "\n")

meanOutputCoverage <- results %>%
  group_by(project, bug_id, case, configuration) %>%
  summarise(mean_output_coverage = mean(OutputCoverage),
            sd_output_coverage = sd(OutputCoverage)) %>%
  as.data.frame()

apply_conover(meanOutputCoverage$mean_output_coverage, 
              meanOutputCoverage$configuration, 
              meanOutputCoverage$case)

apply_friedman_test(meanOutputCoverage$mean_output_coverage, 
                    meanOutputCoverage$configuration, 
                    meanOutputCoverage$case)

pdf("output/appendix-output-friedman-nemenyi.pdf", width=7, height=4) 
meanOutputCoverage %>%
  select(case, configuration, mean_output_coverage) %>%
  mutate(mean_output_coverage = 1 - mean_output_coverage) %>% #The lowest is the best in our case
  pivot_wider(names_from = configuration, values_from = mean_output_coverage) %>%
  select(-case) %>%
  as.matrix() %>%
  nemenyi(plottype = "vmcb", conf.level = 1.0 - SIGNIFICANCE_LEVEL)
dev.off()


# ######################################################
# Implicit Methods Exceptions
# ######################################################

# Filter out cases for which the maximum number of Implicit Methods Exceptions is 0
resultsExceptionCoverage <- results %>%
  filter(!is.nan(ExceptionCoverage))

pairwiseExceptionCoverage <- resultsExceptionCoverage %>%
  filter(configuration != 'DynaMOSA') %>%
  inner_join(
    resultsExceptionCoverage %>%
      filter(configuration == 'DynaMOSA'),
    by = c('project', 'bug_id', 'case', 'TARGET_CLASS'),
    suffix = c('.config', '.base')) %>%
  group_by(project, bug_id, case, TARGET_CLASS, configuration.config)  %>%
  summarise(ExceptionCoverage.VD.magnitude = VD.A(ExceptionCoverage.config, ExceptionCoverage.base)$magnitude,
            ExceptionCoverage.VD.estimate = VD.A(ExceptionCoverage.config, ExceptionCoverage.base)$estimate,
            ExceptionCoverage.wilcox.test.pvalue = wilcox.test(ExceptionCoverage.config, ExceptionCoverage.base)$p.value) %>%
  mutate(ExceptionCoverage.VD.estimate.category = case_when(
    ExceptionCoverage.VD.estimate < 0.5 ~ '< 0.5',
    ExceptionCoverage.VD.estimate > 0.5 ~ '> 0.5',
    TRUE ~ '= 0.5'))

resultsExceptionCoverage %>%
  group_by(configuration) %>%
  summarise(mean_exception_coverage = mean(ExceptionCoverage),
            sd_exception_coverage = sd(ExceptionCoverage),
            median_exception_coverage = median(ExceptionCoverage),
            iqr_exception_coverage = IQR(ExceptionCoverage)) %>%
  arrange(mean_exception_coverage)

resultsExceptionCoverage %>%
  ggplot(aes(x = configuration, y = ExceptionCoverage)) +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  xlab(NULL) +
  ylab('Exception coverage') +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5))
ggsave("output/appendix-exception-coverage.pdf", width = 4.5, height = 3)

# Plotting VD-estimate for significant cases
pairwiseExceptionCoverage %>%
  filter(ExceptionCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  ggplot(aes(x = configuration.config, y = ExceptionCoverage.VD.estimate)) +
  geom_boxplot() +
  stat_summary(
    fun.data = function(x){stat_box_data(x, upper_limit = 1.15)}, 
    geom = "text", 
    hjust = 0.5,
    vjust = 0.9
  ) +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  geom_hline(yintercept = 0.5, linetype=2, color="blue") +
  xlab(NULL) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab('VD') +
  scale_y_continuous(limits = c (0.0, 1.2), breaks = c(0.25, 0.5, 0.75, 1.0))
ggsave("output/appendix-exception-vd.pdf", width = 4.5, height = 3.5)

# Exception coverage effect size magnitude

pairwise_magnitude <- pairwiseExceptionCoverage %>%
  filter(ExceptionCoverage.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  filter(ExceptionCoverage.VD.magnitude != "negligible") %>%
  rename(magnitude = ExceptionCoverage.VD.magnitude,
         category = ExceptionCoverage.VD.estimate.category,
         configuration = configuration.config) %>%
  group_by(magnitude, category, configuration) %>%
  summarise(count = n())

pairwise_magnitude %>% 
  ggplot(aes(x=configuration, fill=magnitude)) +
  geom_bar(data = filter(pairwise_magnitude, category == '> 0.5'), 
           aes(y = count, fill = magnitude), stat = "identity") +
  geom_bar(data = filter(pairwise_magnitude, category == '< 0.5'), 
           aes(y = -count, fill = magnitude), stat = "identity") +
  geom_hline(yintercept=0) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab("Count") +
  scale_fill_brewer(palette = COLOR_PALETTE)
ggsave("output/appendix-exception-magnitude.pdf", width = 4.5, height = 3.5)

cat("Exception coverage effect size magnitude: \n")
pairwise_magnitude %>%
  filter(magnitude == 'large') %>%
  arrange(count) %>%
  print(n = Inf)

# Analysis using Friedman's test

cat("Ranking for Exception Coverage:", "\n")

meanExceptionCoverage <- resultsExceptionCoverage %>%
  group_by(project, bug_id, case, configuration) %>%
  summarise(mean_exception_coverage = mean(ExceptionCoverage),
            sd_exception_coverage = sd(ExceptionCoverage)) %>%
  as.data.frame()

apply_conover(meanExceptionCoverage$mean_exception_coverage, 
              meanExceptionCoverage$configuration, 
              meanExceptionCoverage$case)

apply_friedman_test(meanExceptionCoverage$mean_exception_coverage, 
                    meanExceptionCoverage$configuration, 
                    meanExceptionCoverage$case)

pdf("output/appendix-exception-friedman-nemenyi.pdf", width=7, height=4) 
meanExceptionCoverage %>%
  select(case, configuration, mean_exception_coverage) %>%
  mutate(mean_exception_coverage = 1 - mean_exception_coverage) %>% #The lowest is the best in our case
  pivot_wider(names_from = configuration, values_from = mean_exception_coverage) %>%
  select(-case) %>%
  as.matrix() %>%
  nemenyi(plottype = "vmcb", conf.level = 1.0 - SIGNIFICANCE_LEVEL)
dev.off()



# ######################################################
# Weak mutation 
# ######################################################

results %>%
  group_by(configuration) %>%
  summarise(mean_branch_coverage = mean(WeakMutationScore),
            sd_branch_coverage = sd(WeakMutationScore),
            median_branch_coverage = median(WeakMutationScore),
            iqr_branch_coverage = IQR(WeakMutationScore)) %>%
  arrange(mean_branch_coverage)

results %>%
  ggplot(aes(x = configuration, y = WeakMutationScore)) +
  geom_boxplot() +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  xlab(NULL) +
  ylab('Weak mutation score') +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5))
ggsave("output/appendix-weak-mutation-score.pdf", width = 4.5, height = 3)

# Plotting VD-estimate for significant cases
pairwise %>%
  filter(WeakMutationScore.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  ggplot(aes(x = configuration.config, y = WeakMutationScore.VD.estimate)) +
  geom_boxplot() +
  stat_summary(
    fun.data = function(x){stat_box_data(x, upper_limit = 1.15)}, 
    geom = "text", 
    hjust = 0.5,
    vjust = 0.9
  ) +
  stat_summary(
    fun = mean,
    geom = "point",
    shape = 0,
    color = "black",
    fill = "white"
  ) +
  geom_hline(yintercept = 0.5, linetype=2, color="blue") +
  xlab(NULL) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab('VD') +
  scale_y_continuous(limits = c (0.0, 1.2), breaks = c(0.25, 0.5, 0.75, 1.0))
ggsave("output/appendix-weak-mutation-vd.pdf", width = 4.5, height = 3.5)

# Output coverage effect size magnitude

pairwise_magnitude <- pairwise %>%
  filter(WeakMutationScore.wilcox.test.pvalue <= SIGNIFICANCE_LEVEL) %>%
  filter(WeakMutationScore.VD.magnitude != "negligible") %>%
  rename(magnitude = WeakMutationScore.VD.magnitude,
         category = WeakMutationScore.VD.estimate.category,
         configuration = configuration.config) %>%
  group_by(magnitude, category, configuration) %>%
  summarise(count = n())

pairwise_magnitude %>% 
  ggplot(aes(x=configuration, fill=magnitude)) +
  geom_bar(data = filter(pairwise_magnitude, category == '> 0.5'), 
           aes(y = count, fill = magnitude), stat = "identity") +
  geom_bar(data = filter(pairwise_magnitude, category == '< 0.5'), 
           aes(y = -count, fill = magnitude), stat = "identity") +
  geom_hline(yintercept=0) +
  theme(axis.text.x = element_text(angle = 55, vjust = 0.5)) +
  ylab("Count") +
  scale_fill_brewer(palette = COLOR_PALETTE)
ggsave("output/appendix-weak-mutation-magnitude.pdf", width = 4.5, height = 3.5)

cat("Weak mutation effect size magnitude: \n")
pairwise_magnitude %>%
  filter(magnitude == 'large') %>%
  arrange(count) %>%
  print(n = Inf)

# Analysis using Friedman's test

cat("Ranking for Weak mutation:", "\n")

meanWeakMutationScore <- results %>%
  group_by(project, bug_id, case, configuration) %>%
  summarise(mean_weak_mutation_score = mean(WeakMutationScore),
            sd_weak_mutation_score = sd(WeakMutationScore)) %>%
  as.data.frame()

apply_conover(meanWeakMutationScore$mean_weak_mutation_score, 
              meanWeakMutationScore$configuration, 
              meanWeakMutationScore$case)

apply_friedman_test(meanWeakMutationScore$mean_weak_mutation_score, 
                    meanWeakMutationScore$configuration, 
                    meanWeakMutationScore$case)

pdf("output/appendix-weak-mutation-friedman-nemenyi.pdf", width=7, height=4)
meanWeakMutationScore %>%
  select(case, configuration, mean_weak_mutation_score) %>%
  mutate(mean_weak_mutation_score = 1 - mean_weak_mutation_score) %>% #The lowest is the best in our case
  pivot_wider(names_from = configuration, values_from = mean_weak_mutation_score) %>%
  select(-case) %>%
  as.matrix() %>%
  nemenyi(plottype = "vmcb", conf.level = 1.0 - SIGNIFICANCE_LEVEL)
dev.off()



# ######################################################
# Faults Coverage
# ######################################################

temp2 <- temp %>%
  filter(better == 1) %>%
  mutate(cases = paste0(project,"-",bug_id))


faults <- getFailureCoverage()

pairwise_faults <- faults %>%
  #filter(configuration != 'DynaMOSA') %>%
  inner_join(
    faults %>%
      filter(configuration == 'DynaMOSA'),
    by = c('project', 'bug_id', 'TARGET_CLASS'),
    suffix = c('.config', '.base')) %>%
  mutate(odds_ratio = computeOddsRatio(coverage_rate.config, coverage_rate.base),
         fisher_test = computeFishersExactTest(coverage_rate.config, coverage_rate.base)) %>%
  mutate(better = if_else(odds_ratio > 1, 1, 0, 0),
         nodiff = if_else(odds_ratio == 1, 1, 0, 0),
         worse = if_else(odds_ratio < 1, 1, 0, 0),
         reveraled = if_else(coverage_rate.config > 0, 1, 0, 0)) %>%
  group_by(configuration.config, configuration.base) %>%
  summarise(count = n(),
            count_revealed = sum(reveraled),
            bettercount = sum(better),
            nodiffcount = sum(nodiff),
            worsecount = sum(worse),
            mean_coverage_rate.config = mean(coverage_rate.config),
            sd_coverage_rate.config = sd(coverage_rate.config)) 

outputFile <- "output/appendix-table-real-faults.tex"
unlink(outputFile)
# Redirect cat outputs to file
sink(outputFile, append = TRUE, split = TRUE)
# cats
cat("% Total number of classes under test: ", pairwise_faults[[1, 'count']],"\n")
cat("\\begin{tabular}{ l | c c c | c c c }\n")
#cat("\\hline", "\n")
cat("\\textbf{Config.}", "&",
    "\\multicolumn{3}{c|}{\\textbf{Faults coverage}}", "&",
    "\\multicolumn{3}{c}{\\textbf{Odds ratio}}")
cat(" \\\\", "\n")
cat(" ", "&",
    "$\\#$", "&", "$\\overline{freq.}$", "&", "$\\sigma$", "&", 
    "$>1$", "&", "$=1$", "&", "$<1$")
cat(" \\\\", "\n")
cat("\\hline", "\n")
for(row in seq(from=1, to=nrow(pairwise_faults), by=1)){
  cat(as.character(pairwise_faults[[row, 'configuration.config']]), " & ", 
      pairwise_faults[[row, 'count_revealed']], " & ", 
      "$", formatC(pairwise_faults[[row, 'mean_coverage_rate.config']] *100 / TOTAL_RUNS, digits = 2, format = "f"), "\\%$", " & ", 
      "$", formatC(pairwise_faults[[row, 'sd_coverage_rate.config']] *100 / TOTAL_RUNS, digits = 2, format = "f"), "\\%$", " & ", 
      if_else(pairwise_faults[[row, 'bettercount']] > 0, as.character(pairwise_faults[[row, 'bettercount']]), '-', '-') , " & ",
      if_else(pairwise_faults[[row, 'nodiffcount']] > 0, as.character(pairwise_faults[[row, 'nodiffcount']]), '-', '-') , " & ",
      if_else(pairwise_faults[[row, 'worsecount']] > 0, as.character(pairwise_faults[[row, 'worsecount']]), '-', '-'), sep ="")
  cat(" \\\\", "\n")
}
cat("\\end{tabular}")
sink()